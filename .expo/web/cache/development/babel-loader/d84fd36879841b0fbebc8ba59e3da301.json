{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useRef, useState, useEffect } from 'react';\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Animated from \"react-native-web/dist/exports/Animated\";\nimport { ViewPropTypes } from \"react-native-web/dist/index\";\nimport { node } from 'prop-types';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default function KeyboardSafeView(_ref) {\n  var children = _ref.children,\n      style = _ref.style;\n  var initialViewHeight = useRef(null);\n  var animatedViewHeight = useRef(null);\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      viewHeight = _useState2[0],\n      setViewHeight = _useState2[1];\n\n  useEffect(function () {\n    Keyboard.addListener('keyboardDidShow', handleShow);\n    Keyboard.addListener('keyboardDidHide', handleHide);\n    return function () {\n      Keyboard.removeListener('keyboardDidShow', handleShow);\n      Keyboard.removeListener('keyboardDidHide', handleHide);\n    };\n  }, []);\n  useEffect(function () {\n    if ([initialViewHeight, animatedViewHeight, viewHeight].some(function (val) {\n      return val === null;\n    })) {\n      return;\n    }\n\n    if (viewHeight === initialViewHeight.current) {\n      Animated.timing(animatedViewHeight.current, {\n        toValue: initialViewHeight.current,\n        duration: 300,\n        useNativeDriver: false\n      }).start();\n    } else {\n      Animated.timing(animatedViewHeight.current, {\n        toValue: viewHeight,\n        duration: 300,\n        useNativeDriver: false\n      }).start();\n    }\n  }, [viewHeight]);\n\n  var handleShow = function handleShow(_ref2) {\n    var endCoordinates = _ref2.endCoordinates;\n\n    if (endCoordinates.height && initialViewHeight.current) {\n      var keyboardHeight = Dimensions.get('window').height - endCoordinates.screenY;\n      setViewHeight(initialViewHeight.current - keyboardHeight);\n    }\n  };\n\n  var handleHide = function handleHide() {\n    setViewHeight(initialViewHeight.current);\n  };\n\n  var handleLayout = function handleLayout(_ref3) {\n    var nativeEvent = _ref3.nativeEvent;\n\n    if (!initialViewHeight.current) {\n      var height = nativeEvent.layout.height;\n      initialViewHeight.current = height;\n      animatedViewHeight.current = new Animated.Value(height);\n    }\n  };\n\n  var animatedStyle = viewHeight ? {\n    height: animatedViewHeight.current,\n    flex: 0\n  } : {};\n  return _jsx(Animated.View, {\n    style: [style, animatedStyle],\n    onLayout: handleLayout,\n    children: children\n  });\n}\nKeyboardSafeView.propTypes = {\n  children: node.isRequired\n};\nKeyboardSafeView.defaultProps = {\n  style: null\n};","map":{"version":3,"names":["React","useRef","useState","useEffect","ViewPropTypes","node","KeyboardSafeView","children","style","initialViewHeight","animatedViewHeight","viewHeight","setViewHeight","Keyboard","addListener","handleShow","handleHide","removeListener","some","val","current","Animated","timing","toValue","duration","useNativeDriver","start","endCoordinates","height","keyboardHeight","Dimensions","get","screenY","handleLayout","nativeEvent","layout","Value","animatedStyle","flex","propTypes","isRequired","defaultProps"],"sources":["/Users/atsushi/Dev/baby/src/components/KeyboardSafeView.jsx"],"sourcesContent":["import React, { useRef, useState, useEffect } from 'react';\nimport {\n  Keyboard, Dimensions, Animated, ViewPropTypes,\n} from 'react-native';\nimport { node } from 'prop-types';\n\nexport default function KeyboardSafeView({ children, style }) {\n  const initialViewHeight = useRef(null);\n  const animatedViewHeight = useRef(null);\n  const [viewHeight, setViewHeight] = useState(null);\n\n  useEffect(() => {\n    Keyboard.addListener('keyboardDidShow', handleShow);\n    Keyboard.addListener('keyboardDidHide', handleHide);\n    return () => {\n      Keyboard.removeListener('keyboardDidShow', handleShow);\n      Keyboard.removeListener('keyboardDidHide', handleHide);\n    };\n  }, []);\n\n  useEffect(() => {\n    if ([initialViewHeight, animatedViewHeight, viewHeight].some((val) => val === null)) { return; }\n    // height is not supported with useNativeDriver: true\n    // https://github.com/react-native-community/react-native-modal/issues/163\n    if (viewHeight === initialViewHeight.current) {\n      Animated.timing(animatedViewHeight.current,\n        { toValue: initialViewHeight.current, duration: 300, useNativeDriver: false }).start();\n    } else {\n      Animated.timing(animatedViewHeight.current,\n        { toValue: viewHeight, duration: 300, useNativeDriver: false }).start();\n    }\n  }, [viewHeight]);\n\n  const handleShow = ({ endCoordinates }) => {\n    if (endCoordinates.height && initialViewHeight.current) {\n      const keyboardHeight = Dimensions.get('window').height - endCoordinates.screenY;\n      setViewHeight(initialViewHeight.current - keyboardHeight);\n    }\n  };\n\n  const handleHide = () => {\n    setViewHeight(initialViewHeight.current);\n  };\n\n  const handleLayout = ({ nativeEvent }) => {\n    if (!initialViewHeight.current) {\n      const { height } = nativeEvent.layout;\n      // keep viewHeight as null not to trigger useEffect on mounting.\n      // Don't do this: setViewHeight(height);\n      initialViewHeight.current = height;\n      animatedViewHeight.current = new Animated.Value(height);\n    }\n  };\n\n  const animatedStyle = viewHeight ? {\n    height: animatedViewHeight.current,\n    flex: 0,\n  } : {};\n  return (\n    <Animated.View style={[style, animatedStyle]} onLayout={handleLayout}>\n      {children}\n    </Animated.View>\n  );\n}\n\nKeyboardSafeView.propTypes = {\n  children: node.isRequired,\n  //style: ViewPropTypes.style,\n};\n\nKeyboardSafeView.defaultProps = {\n  style: null,\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}